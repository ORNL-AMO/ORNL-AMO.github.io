<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>AMO Tools</title>
</head>

<body id="body" onload="GetDesktop()">
    <div class="container-fluid" style="padding-left: 0px; padding-right: 0px;">
        <div class="jumbotron banner">
            <h3 class="display-3">AMO Tools Download Center <img src="./DOE-banner-color.png" class="rounded float-right" style="width: 10%; margin-bottom: 15px;"></img>
            </h3>
            <p class="lead" style="width: 75%;">
                AMOâ€™s energy system and energy management software tools help manufacturers increase energy efficiency at the plant-level
                and in specific systems. Learn step-by-step ways to identify opportunities, monitor progress, and improve
                efficiency in any facility by accessing the tools available here.
            </p>

            <div class="row justify-content-end">
                <div class="col">
                    <div class="float-right">Oak Ridge National Laboratory - Advanced Manufacturing Office Tools</div>
                </div>
            </div>
            <div class="row justify-content-end">
                <div class="col">
                    <div class="float-right">For feedback on any of the tools please email: <a href="accawigk@ornl.gov">ORNL-AMO Tools Support</a></div>
                </div>
            </div>
        </div>
        <div class="row justify-content-center" style="margin-bottom: 25px;">
            <div class="col-5">
                <div id="desktop-list-group" class="list-group">
                    <div class="list-group-item download-title">
                        <div class="row align-items-center">
                            <div class="col-2"><img src="./desktop-icon.png" class="rounded float-left" style="width: 100%; margin-bottom: 10px;"></div>
                            <div class="col-10">
                                <h5><b>Desktop Application Downloads</b><span class="badge badge-success float-right" id="desktop-title"></span></h5>
                            </div>
                        </div>
                        <p class="details">AMO-Tools-Desktop is an energy efficiency calculation application for use with industrial equipment
                            such as pumps, furnaces, fans, and motors, as well as for industrial systems such as steam.
                        </p>
                        <p class="details">The application is based on AMO legacy tools, such as PSAT, PHAST, FSAT and the SSMT.</p>
                        <p class="details">Choose the proper installer to download for your operating system, and then run the installer after
                            the download is finished to begin optimizing your facility</p>
                        <p class="details">For more information visit: <a href="https://github.com/ORNL-AMO/AMO-Tools-Desktop">https://github.com/ORNL-AMO/AMO-Tools-Desktop</a></p>
                    </div>

                </div>
            </div>
            <div class="col-5">
                <div id="suite-list-group" class="list-group">
                    <div class="list-group-item download-title">
                        <div class="row align-items-center">
                            <div class="col-2"><img src="./suite-icon.png" class="rounded float-left" style="width: 100%; margin-bottom: 10px;"></div>
                            <div class="col-10">
                                <h5><b>Tools Suite Downloads</b>
                                    <span class="badge badge-success float-right" id="suite-title"></span>
                                </h5>
                            </div>
                        </div>
                        <p class="details">This is a pre-release version of the U.S. Department of Energy (DOE) Advanced Manufacturing Office
                            (AMO) Tools Suite.</p>
                        <p class="details">The suite can be installed locally using a downloaded version from the list below by running the
                            following command: <b>npm install /path/to/download</b></p>
                        <p class="details">The suite can also be installed from npm: <b>npm install amo-tools-suite</b></p>
                        <p class="details">For more information visit: <a href="https://github.com/ORNL-AMO/AMO-Tools-Suite">https://github.com/ORNL-AMO/AMO-Tools-Suite</a></p>
                    </div>

                </div>
            </div>
        </div>
        <div class="row justify-content-center" style="margin-bottom: 25px;">
            <div class="col-5">
                <div id="enpi-list-group" class="list-group">
                    <div class="list-group-item download-title">
                        <h5><b>EnPI Downloads</b><span class="badge badge-success float-right" id="enpi-title"></span></h5>
                        <p class="details">The EnPI V5.0 is a regression analysis based tool designed to help plant and corporate managers establish
                            a normalized baseline of energy consumption and track annual progress of energy performance indicators
                            (EnPIs).
                        </p>
                        <p class="details">For more information visit: <a href="https://github.com/ORNL-AMO/EnPI">https://github.com/ORNL-AMO/EnPI</a></p>
                    </div>

                </div>
            </div>
            <div class="col-5">
                <div id="phastex-list-group" class="list-group">
                    <div class="list-group-item download-title">
                        <h5><b>PHASTEx Downloads</b><span class="badge badge-success float-right" id="phastex-title"></span></h5>
                        <p class="details">PHASTex (Process Heating Assessment and Survey Tool - Excel Version) is an Excel workbook for calculating
                            energy efficiency in industrial fuel-fired furnaces.</p>
                        <p class="details">No installation required, simply open the spreadsheet within Microsoft Excel</p>
                        <p class="details">For more information visit: <a href="https://github.com/ORNL-AMO/PHASTEx">https://github.com/ORNL-AMO/PHASTEx</a></p>
                    </div>

                </div>
            </div>
        </div>

    </div>
    <script type="text/javascript" language="javascript">
        function GetDesktop() {
            var xhttp = new XMLHttpRequest();
            xhttp.open("GET", "https://api.github.com/repos/ORNL-AMO/AMO-Tools-Desktop/releases/latest", false);
            xhttp.setRequestHeader("Content-type", "application/json");
            xhttp.send();
            var response = JSON.parse(xhttp.responseText);
            // console.log(response)
            let version = document.createTextNode(' ' + response.tag_name);
            document.getElementById('desktop-title').appendChild(version);
            if (response.assets) {
                let totalDownloads = 0;
                response.assets.forEach(function (element) {
                    totalDownloads = totalDownloads + element.download_count;
                    let debTest = isExt(element.name, '.deb');
                    if (debTest) {
                        addDesktopListItem(element, 'AMO Desktop Linux (.deb)');
                    }
                    let tarTest = isExt(element.name, '.tar.gz');
                    if (tarTest) {
                        addDesktopListItem(element, 'AMO Desktop Linux (.tar.gz)');
                    }
                    let dmgTest = isExt(element.name, '.dmg');
                    if (dmgTest) {
                        addDesktopListItem(element, 'AMO Desktop Mac (.dmg)');
                    }
                    let zipTest = isExt(element.name, '.zip');
                    if (zipTest) {
                        addDesktopListItem(element, 'AMO Desktop Mac (.zip)');
                    }
                    let exeTest = isExt(element.name, '.exe');
                    if (exeTest) {
                        addDesktopListItem(element, 'AMO Desktop Windows (.exe)');
                    }
                }, this);
                var div = document.createElement('div');
                var list = document.getElementById('desktop-list-group');
                div.textContent = 'Total Downloads: ' + totalDownloads;
                div.className = "list-group-item total-downloads";
                list.appendChild(div);
            }
            GetSuite();
            GetENPI();
            GetPHASTEx();
            //let lastUpdated = document.createTextNode('Published: ' + response.published_at);
            //document.getElementById('last-updated').appendChild(lastUpdated);
        }

        function GetSuite() {
            var xhttp = new XMLHttpRequest();
            xhttp.open("GET", "https://api.github.com/repos/ORNL-AMO/AMO-Tools-Suite/releases/latest", false);
            xhttp.setRequestHeader("Content-type", "application/json");
            xhttp.send();
            var response = JSON.parse(xhttp.responseText);
            let version = document.createTextNode(' ' + response.tag_name);
            document.getElementById('suite-title').appendChild(version);
            if (response.assets) {
                let totalDownloads = 0;
                response.assets.forEach(function (element) {
                    totalDownloads = totalDownloads + element.download_count;
                    let zTest = isExt(element.name, '.Z');
                    if (zTest) {
                        addSuiteListItem(element, 'AMO Suite Linux (.Z)');
                    }
                    let tarTest = isExt(element.name, '.tar.gz');
                    let macTest = isExt(element.name, 'Darwin');
                    if (tarTest && !macTest) {
                        addSuiteListItem(element, 'AMO Suite Linux (.tar.gz)');
                    }
                    if (tarTest && macTest) {
                        addSuiteListItem(element, 'AMO Suite Mac (.tar.gz)');
                    }
                    let shTest = isExt(element.name, '.sh');
                    if (shTest) {
                        addSuiteListItem(element, 'AMO Suite Mac (.sh)');
                    }
                    let exeTest = isExt(element.name, '.exe');
                    if (exeTest) {
                        addSuiteListItem(element, 'AMO Suite Windows (.exe)');
                    }
                }, this);
                var div = document.createElement('div');
                var list = document.getElementById('suite-list-group');
                div.textContent = 'Total Downloads: ' + totalDownloads;
                div.className = "list-group-item total-downloads";
                list.appendChild(div);
            }
        }


        function GetENPI() {
            var xhttp = new XMLHttpRequest();
            xhttp.open("GET", "https://api.github.com/repos/ORNL-AMO/EnPI/releases/latest", false);
            xhttp.setRequestHeader("Content-type", "application/json");
            xhttp.send();
            var response = JSON.parse(xhttp.responseText);
            let version = document.createTextNode(' ' + response.tag_name);
            document.getElementById('enpi-title').appendChild(version);
            if (response.assets) {
                let totalDownloads = 0;
                response.assets.forEach(function (element) {
                    totalDownloads = totalDownloads + element.download_count;
                    var label = 'EnPI';
                    if (isExt(element.name, '64')) {
                        label = 'EnPI (64.msi)';
                    } else if (isExt(element.name, '86')) {
                        label = 'EnPI (86.msi)';
                    }
                    var a = document.createElement('a');
                    var list = document.getElementById('enpi-list-group');
                    a.textContent = label;
                    a.className = "list-group-item list-group-item-action";
                    a.setAttribute("href", element.browser_download_url);
                    list.appendChild(a);
                })
                var div = document.createElement('div');
                var list = document.getElementById('enpi-list-group');
                div.textContent = 'Total Downloads: ' + totalDownloads;
                div.className = "list-group-item total-downloads";
                list.appendChild(div);
            }
        }

        function GetPHASTEx() {
            var xhttp = new XMLHttpRequest();
            xhttp.open("GET", "https://api.github.com/repos/ORNL-AMO/PHASTEx/releases/latest", false);
            xhttp.setRequestHeader("Content-type", "application/json");
            xhttp.send();
            var response = JSON.parse(xhttp.responseText);
            let version = document.createTextNode(' ' + response.tag_name);
            document.getElementById('phastex-title').appendChild(version);
            if (response.assets) {
                let totalDownloads = 0;
                response.assets.forEach(function (element) {
                    totalDownloads = totalDownloads + element.download_count;
                    var label = 'PHASTEx (.xlsm)';
                    var a = document.createElement('a');
                    var list = document.getElementById('phastex-list-group');
                    a.textContent = label;
                    a.className = "list-group-item list-group-item-action";
                    a.setAttribute("href", element.browser_download_url);
                    list.appendChild(a);
                })
                var div = document.createElement('div');
                var list = document.getElementById('phastex-list-group');
                div.textContent = 'Total Downloads: ' + totalDownloads;
                div.className = "list-group-item total-downloads";
                list.appendChild(div);
            }
        }

        function isExt(name, ext) {
            let debExp = name.indexOf(ext);
            if (debExp !== -1) {
                return true;
            } else {
                return false;
            }
        }

        function addDesktopListItem(element, label) {
            var a = document.createElement('a');
            var list = document.getElementById('desktop-list-group');
            a.textContent = label;
            a.className = "list-group-item list-group-item-action";
            a.setAttribute("href", element.browser_download_url);
            list.appendChild(a);
        }
        function addSuiteListItem(element, label) {
            var a = document.createElement('a');
            var list = document.getElementById('suite-list-group');
            a.textContent = label;
            a.className = "list-group-item list-group-item-action";
            a.setAttribute("href", element.browser_download_url);
            list.appendChild(a);
        }
    </script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M"
        crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1"
        crossorigin="anonymous"></script>

    <style>
        .download-title {
            border-color: #7CC110;
            border-width: 10px;

            font-weight: bold;
        }

        a {
            color: #196F3D;
        }

        .banner {
            border-color: #7CC110;
            border-width: 10px;
            border-style: solid;
        }

        .total-downloads {
            background-color: #196F3D;
            color: white;
            font-weight: bold;
            text-align: right;
        }

        .badge-success {
            background-color: #196F3D !important;
        }

        .list-group-item-action:hover {
            background-color: #D6EAF8;
            cursor: pointer;
            text-decoration: underline;
            color: #196F3D;
        }

        .details {
            font-size: 90%;
            font-weight: 400;
        }

        body {
            background-color: #D5D8DC;
        }
    </style>


</body>

</html>